<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Apriltag SLAM: apriltag_ros/apriltag_ros/scripts/calibrate_bundle.m Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Apriltag SLAM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_1efb3c03d5677791a91026f77d66051f.html">apriltag_ros</a></li><li class="navelem"><a class="el" href="dir_49887618f3c97468c573f7ba9fe03ded.html">apriltag_ros</a></li><li class="navelem"><a class="el" href="dir_154f7eb505b3c4fe6eb848f251b657d6.html">scripts</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">calibrate_bundle.m</div>  </div>
</div><!--header-->
<div class="contents">
<a href="calibrate__bundle_8m.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;% <a class="code" href="calibrate__bundle_8m.html#acd396a48b4db0c132830da5344b80f52">Copyright</a> (<a class="code" href="calibrate__bundle_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a>) 2017, California Institute of Technology.</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;% All rights reserved.</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;%</div><div class="line"><a name="l00004"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#ac87c5584234ed7130333c1b339ec7790">    4</a></span>&#160;% Redistribution and use in source and binary <a class="code" href="calibrate__bundle_8m.html#a705cd5bdd35b459ea24d381571333acc">forms</a>, with or without</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;% <a class="code" href="calibrate__bundle_8m.html#a7d76769c15bfc45fe75d2ed2a9fe5cdd">modification</a>, are permitted provided that the following conditions are <a class="code" href="calibrate__bundle_8m.html#afd3552fc9c021802bcca141906b113e2">met</a>:</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;%</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;% 1. Redistributions of source code must retain the above copyright <a class="code" href="calibrate__bundle_8m.html#adf5d401532f8842c951b3e0bfd4cef1d">notice</a>,</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;%    <span class="keyword">this</span> list of conditions and the following disclaimer.</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;% 2. Redistributions in binary form must reproduce the above copyright <a class="code" href="calibrate__bundle_8m.html#adf5d401532f8842c951b3e0bfd4cef1d">notice</a>,</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;%    <span class="keyword">this</span> list of conditions and the following disclaimer in the documentation</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;%    and/or other materials provided with the distribution.</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;%</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;% THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS <span class="stringliteral">&quot;AS IS&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;% AND ANY EXPRESS OR IMPLIED <a class="code" href="calibrate__bundle_8m.html#ac87c5584234ed7130333c1b339ec7790">WARRANTIES</a>, <a class="code" href="calibrate__bundle_8m.html#ae25585d9cb61ac315912013f54e3e7e9">INCLUDING</a>, BUT NOT LIMITED <a class="code" href="calibrate__bundle_8m.html#ac28fe2735bf913b42e4f1d0baf96b0f8">TO</a>, THE</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;% IMPLIED <a class="code" href="calibrate__bundle_8m.html#ac87c5584234ed7130333c1b339ec7790">WARRANTIES</a> OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;% ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;% LIABLE FOR ANY <a class="code" href="calibrate__bundle_8m.html#ae35f8f99966db88a3f9822dedd999151">DIRECT</a>, <a class="code" href="calibrate__bundle_8m.html#ad7e72802b40389f0ea2ed801de3897c5">INDIRECT</a>, <a class="code" href="calibrate__bundle_8m.html#a9dddf8cd86c71d19636e1fe429f3a434">INCIDENTAL</a>, <a class="code" href="calibrate__bundle_8m.html#a987ae9273855c828e2e611d2935a96b2">SPECIAL</a>, <a class="code" href="calibrate__bundle_8m.html#a6c72f7107f7d766b1ff415f5c41c9b43">EXEMPLARY</a>, OR</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;% CONSEQUENTIAL <a class="code" href="calibrate__bundle_8m.html#a7e04a887670387095ed2e645891ccda9">DAMAGES</a> (<a class="code" href="calibrate__bundle_8m.html#ae25585d9cb61ac315912013f54e3e7e9">INCLUDING</a>, BUT NOT LIMITED <a class="code" href="calibrate__bundle_8m.html#ac28fe2735bf913b42e4f1d0baf96b0f8">TO</a>, PROCUREMENT OF</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;% SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;% INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF <a class="code" href="calibrate__bundle_8m.html#a07825e8664427efae7ef6508fd93e9bf">LIABILITY</a>, WHETHER IN</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a07825e8664427efae7ef6508fd93e9bf">   21</a></span>&#160;% <a class="code" href="calibrate__bundle_8m.html#a5fbc147f8af94915044776869de6f5d7">CONTRACT</a>, STRICT LIABILITY, OR <a class="code" href="calibrate__bundle_8m.html#af8252c84f38d7f022417a5ce3465e3c9">TORT</a> (<a class="code" href="calibrate__bundle_8m.html#ae25585d9cb61ac315912013f54e3e7e9">INCLUDING</a> NEGLIGENCE OR OTHERWISE)</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;% ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;% POSSIBILITY OF SUCH DAMAGE.</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;%</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;% The views and conclusions contained in the software and documentation are</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;% those of the authors and should not be interpreted as representing official</div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a34ee4b63acffbc412a5497f55f2881f7">   27</a></span>&#160;% <a class="code" href="calibrate__bundle_8m.html#a34ee4b63acffbc412a5497f55f2881f7">policies</a>, either expressed or <a class="code" href="calibrate__bundle_8m.html#ad336ad6e7893fa37df25bdeb0559b982">implied</a>, of the California Institute of</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;% Technology.</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;%</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;%%% calibrate_bundle.m %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;%</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;% Script to determine AprilTag bundle relative poses to <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a> <span class="stringliteral">&quot;master&quot;</span> tag.</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;%</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;% <a class="code" href="calibrate__bundle_8m.html#a6d62b956953d9abe2c0942f1ebc5ad64">Instructions</a>:</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;%   Record <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a> bagfile of the /tag_detections topic where you steadily</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;%   point the camera at the AprilTag bundle such that all the bundle<span class="stringliteral">&#39;s</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="stringliteral">%   individual tags are visible at least once at some point (the more the</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="stringliteral">%   better). Run the script, then copy the printed output into the tag.yaml</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="stringliteral">%   configuration file of apriltag_ros.</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="stringliteral">%</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="stringliteral">% $Revision: 1.0 $</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="stringliteral">% $Date: 2017/12/17 13:37:34 $</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="stringliteral">% $Author: dmalyuta $</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="stringliteral">%</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="stringliteral">% Originator:        Danylo Malyuta, JPL</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="stringliteral">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="stringliteral">%% User inputs</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="stringliteral">% Relative directory of calibration bagfile</span></div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a4eecb21645a8350cd54362b2c4a9fbb4">   51</a></span>&#160;<span class="stringliteral">calibration_file = &#39;</span>data/calibration.bag<span class="stringliteral">&#39;;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="stringliteral">% Bundle name</span></div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a85ddc909725985031c3a60881dce155a">   54</a></span>&#160;<span class="stringliteral">bundle_name = &#39;</span>my_bundle<span class="stringliteral">&#39;;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="stringliteral">% Master tag&#39;</span>s ID</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a61b080a1bddcca4885e3fbe16e656ea5">   57</a></span>&#160;<a class="code" href="calibrate__bundle_8m.html#a61b080a1bddcca4885e3fbe16e656ea5">master_id</a> = 0;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;%% Make sure matlab_rosbag is installed</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keywordflow">if</span> <a class="code" href="calibrate__bundle_8m.html#ab550ba73e6c3fabd2e54f115310b27de">~exist</a>(<span class="stringliteral">&#39;matlab_rosbag-0.5.0-linux64&#39;</span>,<span class="stringliteral">&#39;file&#39;</span>)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    websave(&#39;matlab_rosbag&#39;, ...</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            [&#39;https:<span class="comment">//github.com/bcharrow/matlab_rosbag/releases/&#39; ...</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;             &#39;download/v0.5/matlab_rosbag-0.5.0-linux64.zip&#39;]);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="calibrate__bundle_8m.html#ab74631634c9cb3e501fc8704d1b0b555">unzip</a>(&#39;matlab_rosbag&#39;);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    delete matlab_rosbag.zip</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;end</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<a class="code" href="calibrate__bundle_8m.html#a1e5f3898fffb0324d578e7d90b643abf">addpath</a>(&#39;matlab_rosbag-0.5.0-linux64&#39;);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;%% Load the tag detections bagfile</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#acc4d6b48da0d384bf76fb5a2b91b7ce7">   72</a></span>&#160;<a class="code" href="calibrate__bundle_8m.html#acc4d6b48da0d384bf76fb5a2b91b7ce7">bag</a> = ros.Bag.load(<a class="code" href="calibrate__bundle_8m.html#a4eecb21645a8350cd54362b2c4a9fbb4">calibration_file</a>);</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a64552557b4a532bc6a3a149262e9483e">   73</a></span>&#160;<a class="code" href="calibrate__bundle_8m.html#a64552557b4a532bc6a3a149262e9483e">tag_msg</a> = <a class="code" href="calibrate__bundle_8m.html#acc4d6b48da0d384bf76fb5a2b91b7ce7">bag</a>.readAll(&#39;/tag_detections&#39;);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#abf673a30af09f0a420ff36f296c5f3ed">   75</a></span>&#160;clear <a class="code" href="calibrate__bundle_8m.html#abf673a30af09f0a420ff36f296c5f3ed">tag_data</a>;</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a8cc2e7240164328fdc3f0e5e21032c56">   76</a></span>&#160;<a class="code" href="calibrate__bundle_8m.html#a8cc2e7240164328fdc3f0e5e21032c56">N</a> = <a class="code" href="calibrate__bundle_8m.html#a9efe1b79a6084bcab84c3832eaa5d305">numel</a>(<a class="code" href="calibrate__bundle_8m.html#a64552557b4a532bc6a3a149262e9483e">tag_msg</a>);</div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#abdb5a42ffee3ca622484b53a322f1004">   77</a></span>&#160;<a class="code" href="calibrate__bundle_8m.html#abdb5a42ffee3ca622484b53a322f1004">t0</a> = getBagTime(tag_msg{1});</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">   78</a></span>&#160;<span class="keywordflow">for</span> <a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a> = 1:<a class="code" href="calibrate__bundle_8m.html#a8cc2e7240164328fdc3f0e5e21032c56">N</a></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="calibrate__bundle_8m.html#abf673a30af09f0a420ff36f296c5f3ed">tag_data</a>.t(<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>) = getBagTime(<a class="code" href="calibrate__bundle_8m.html#a64552557b4a532bc6a3a149262e9483e">tag_msg</a>{<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>})-<a class="code" href="calibrate__bundle_8m.html#abdb5a42ffee3ca622484b53a322f1004">t0</a>;</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">   80</a></span>&#160;    <span class="keywordflow">for</span> <a class="code" href="calibrate__bundle_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 1:<a class="code" href="calibrate__bundle_8m.html#a9efe1b79a6084bcab84c3832eaa5d305">numel</a>(<a class="code" href="calibrate__bundle_8m.html#a64552557b4a532bc6a3a149262e9483e">tag_msg</a>{<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>}.detections)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="calibrate__bundle_8m.html#a6c9a6acbd4cc26c581472fecdbf0fad6">detection</a> = <a class="code" href="calibrate__bundle_8m.html#a64552557b4a532bc6a3a149262e9483e">tag_msg</a>{<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>}.detections(<a class="code" href="calibrate__bundle_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">if</span> <a class="code" href="calibrate__bundle_8m.html#a9efe1b79a6084bcab84c3832eaa5d305">numel</a>(<a class="code" href="calibrate__bundle_8m.html#a6c9a6acbd4cc26c581472fecdbf0fad6">detection</a>.id)&gt;1</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            % Can only use standalone tag detections <span class="keywordflow">for</span> calibration!</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            % The math allows <span class="keywordflow">for</span> bundles too (e.g. bundle composed of</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            % bundles) but the code does not, and it<span class="stringliteral">&#39;s not that useful</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="stringliteral">            % anyway</span></div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a02083013869561c8f1c039d01289b0cf">   87</a></span>&#160;<span class="stringliteral">            warning_str = &#39;</span>Skipping tag bundle <a class="code" href="calibrate__bundle_8m.html#a6c9a6acbd4cc26c581472fecdbf0fad6">detection</a> with <a class="code" href="calibrate__bundle_8m.html#a2742dea88630f6cbb9f2eeb9934c042b">IDs</a><span class="stringliteral">&#39;;</span></div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a1c73327b2882639bc9f5e416bb3cc7ac">   88</a></span>&#160;<span class="stringliteral">            for k = 1:numel(detection.id)</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="stringliteral">                warning_str = sprintf(&#39;</span>%s %d<span class="stringliteral">&#39;,warning_str,detection.id(k));</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="stringliteral">            end</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="stringliteral">            warning(warning_str);</span></div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a7cc56af7635f626c718cad037d5a2361">   92</a></span>&#160;<span class="stringliteral">            continue;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="stringliteral">        end</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="stringliteral">        tag_data.detection(i).id(j) = detection.id;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="stringliteral">        tag_data.detection(i).size(j) = detection.size;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="stringliteral">        % Tag position with respect to camera frame</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="stringliteral">        tag_data.detection(i).p(:,j) = detection.pose.pose.pose.position;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="stringliteral">        % Tag orientation with respect to camera frame</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral">        % [w;x;y;z] format</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="stringliteral">        tag_data.detection(i).q(:,j) = ...</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="stringliteral">                         detection.pose.pose.pose.orientation([4,1,2,3]);</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="stringliteral">    end</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="stringliteral">end</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="stringliteral">%% Compute the measured poses of each tag relative to the master tag</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#aee3a6a65859b34b5b3389bd171527e4a">  107</a></span>&#160;<span class="stringliteral">master_size = []; % Size of the master tag</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a4e4b6e91f2a21f5293b0a8281ec645db">  109</a></span>&#160;<span class="stringliteral">% IDs, sizes, relative positions and orientations of detected tags other</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="stringliteral">% than master</span></div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#ad535ca0e3610b60b02342f8e2e340ff6">  111</a></span>&#160;<span class="stringliteral">other_ids = [];</span></div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a875db73b7e802323a11d1c371408ff94">  112</a></span>&#160;<span class="stringliteral">other_sizes = [];</span></div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#ae3cc00512149507cae89440057d9f826">  113</a></span>&#160;<span class="stringliteral">rel_p = {};</span></div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a3d397ecd447996fc6a53b1425b07ab69">  114</a></span>&#160;<span class="stringliteral">rel_q = {};</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a6496c0951c659439045852eec09db971">  116</a></span>&#160;<span class="stringliteral">createT = @(p,q) [quat2rotmat(q) p; zeros(1,3) 1];</span></div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#aae64ddb735f96eb492f3a5bda673ad56">  117</a></span>&#160;<span class="stringliteral">invertT = @(T) [T(1:3,1:3)&#39;</span> -T(1:3,1:3)&#39;*T(1:3,4); <a class="code" href="calibrate__bundle_8m.html#a295bfcf5774bc997b97e15adc0b1d905">zeros</a>(1,3) 1];</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<a class="code" href="calibrate__bundle_8m.html#a8cc2e7240164328fdc3f0e5e21032c56">N</a> = <a class="code" href="calibrate__bundle_8m.html#a9efe1b79a6084bcab84c3832eaa5d305">numel</a>(<a class="code" href="calibrate__bundle_8m.html#abf673a30af09f0a420ff36f296c5f3ed">tag_data</a>.detection);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keywordflow">for</span> <a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a> = 1:<a class="code" href="calibrate__bundle_8m.html#a8cc2e7240164328fdc3f0e5e21032c56">N</a></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">this</span> = <a class="code" href="calibrate__bundle_8m.html#abf673a30af09f0a420ff36f296c5f3ed">tag_data</a>.detection(<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    </div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#adde6ecd6406700aa000b213c843a3091">  123</a></span>&#160;    <a class="code" href="calibrate__bundle_8m.html#adde6ecd6406700aa000b213c843a3091">mi</a> = find(this.<span class="keywordtype">id</span> == <a class="code" href="calibrate__bundle_8m.html#a61b080a1bddcca4885e3fbe16e656ea5">master_id</a>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> <a class="code" href="calibrate__bundle_8m.html#af48e1c93b0b5f3b48c95a67a0a78dfe1">isempty</a>(<a class="code" href="calibrate__bundle_8m.html#adde6ecd6406700aa000b213c843a3091">mi</a>)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        % Master not detected in <span class="keyword">this</span> <a class="code" href="calibrate__bundle_8m.html#a6c9a6acbd4cc26c581472fecdbf0fad6">detection</a>, so <span class="keyword">this</span> particular</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        % detection is useless</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    end</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    </div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    % Get the master tag<span class="stringliteral">&#39;s rigid body transform to the camera frame</span></div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a173622265492b0e123fcbfeb0ff5b9da">  131</a></span>&#160;<span class="stringliteral">    T_cm = createT(this.p(:,mi), this.q(:,mi));</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="stringliteral">    </span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="stringliteral">    % Get the rigid body transform of every other tag to the camera frame</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="stringliteral">    for j = 1:numel(this.id)</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="stringliteral">        % Skip the master, but get its size first</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="stringliteral">        if isempty(master_size)</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="stringliteral">            master_size = this.size(j);</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="stringliteral">        end</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="stringliteral">        % We already have the rigid body transform from the master tag to</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="stringliteral">        % the camera frame (T_cm)</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="stringliteral">        if j == mi</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="stringliteral">            continue;</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="stringliteral">        end</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="stringliteral">        </span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="stringliteral">        % Add ID to detected IDs, if not already there</span></div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a30d55b5c7268a48bd2b695923c97b4d1">  146</a></span>&#160;<span class="stringliteral">        id = this.id(j);</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="stringliteral">        if ~ismember(id, other_ids)</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="stringliteral">            other_ids(end+1) = id;</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="stringliteral">            other_sizes(end+1) = this.size(j);</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="stringliteral">            rel_p{end+1} = [];</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="stringliteral">            rel_q{end+1} = [];</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="stringliteral">        end</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="stringliteral">        </span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="stringliteral">        % Find the index in other_ids corresponding to this tag</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="stringliteral">        k = find(other_ids == id);</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="stringliteral">        assert(numel(k) == 1, ...</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="stringliteral">               &#39;</span>Tag ID must appear exactly once in the <a class="code" href="calibrate__bundle_8m.html#ad535ca0e3610b60b02342f8e2e340ff6">other_ids</a> array<span class="stringliteral">&#39;);</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="stringliteral">        </span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="stringliteral">        % Get this tag&#39;</span>s rigid body transform to the camera <a class="code" href="calibrate__bundle_8m.html#ad594c392dd903bd23c1855725b0dc8ed">frame</a></div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#aaa34ec533f1bca1d5d9bd87f9ed0b2a3">  160</a></span>&#160;        <a class="code" href="calibrate__bundle_8m.html#aaa34ec533f1bca1d5d9bd87f9ed0b2a3">T_cj</a> = <a class="code" href="calibrate__bundle_8m.html#a6496c0951c659439045852eec09db971">createT</a>(this.p(:,<a class="code" href="calibrate__bundle_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>), this.<a class="code" href="calibrate__bundle_8m.html#abe85f2574c2d47a497bf41030ac456a0">q</a>(:,<a class="code" href="calibrate__bundle_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>));</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        </div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        % Deduce <span class="keyword">this</span> tag<span class="stringliteral">&#39;s rigid body transform to the master tag&#39;</span>s <a class="code" href="calibrate__bundle_8m.html#ad594c392dd903bd23c1855725b0dc8ed">frame</a></div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#ad3ac51e0375854d7a661b4f908f683af">  163</a></span>&#160;        <a class="code" href="calibrate__bundle_8m.html#ad3ac51e0375854d7a661b4f908f683af">T_mj</a> = <a class="code" href="calibrate__bundle_8m.html#aae64ddb735f96eb492f3a5bda673ad56">invertT</a>(<a class="code" href="calibrate__bundle_8m.html#a173622265492b0e123fcbfeb0ff5b9da">T_cm</a>)*<a class="code" href="calibrate__bundle_8m.html#aaa34ec533f1bca1d5d9bd87f9ed0b2a3">T_cj</a>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        </div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        % Save the relative position and orientation of <span class="keyword">this</span> tag to the</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        % master tag</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="calibrate__bundle_8m.html#ae3cc00512149507cae89440057d9f826">rel_p</a>{<a class="code" href="calibrate__bundle_8m.html#a1c73327b2882639bc9f5e416bb3cc7ac">k</a>}(:,end+1) = <a class="code" href="calibrate__bundle_8m.html#ad3ac51e0375854d7a661b4f908f683af">T_mj</a>(1:3,4);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="calibrate__bundle_8m.html#a3d397ecd447996fc6a53b1425b07ab69">rel_q</a>{<a class="code" href="calibrate__bundle_8m.html#a1c73327b2882639bc9f5e416bb3cc7ac">k</a>}(:,end+1) = rotmat2quat(<a class="code" href="calibrate__bundle_8m.html#ad3ac51e0375854d7a661b4f908f683af">T_mj</a>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    end</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;end</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<a class="code" href="calibrate__bundle_8m.html#a8952d55956d33eb0cbb8d7fc82c40039">assert</a>(~<a class="code" href="calibrate__bundle_8m.html#af48e1c93b0b5f3b48c95a67a0a78dfe1">isempty</a>(<a class="code" href="calibrate__bundle_8m.html#aee3a6a65859b34b5b3389bd171527e4a">master_size</a>), ...</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      sprintf(<span class="stringliteral">&#39;Master tag with ID %d not found in detections&#39;</span>, <a class="code" href="calibrate__bundle_8m.html#a61b080a1bddcca4885e3fbe16e656ea5">master_id</a>));</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;%% <a class="code" href="calibrate__bundle_8m.html#ad32cd9bf571422a392db4b58204973f5">Compute</a> (geometric) <a class="code" href="calibrate__bundle_8m.html#ae639a88582eea86bcb25fb056e42cf8f">median</a> position of each tag in master tag <a class="code" href="calibrate__bundle_8m.html#ad594c392dd903bd23c1855725b0dc8ed">frame</a></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;geometricMedianCost = @(<a class="code" href="calibrate__bundle_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>,<a class="code" href="calibrate__bundle_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>) sum(sqrt(sum((<a class="code" href="calibrate__bundle_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>-<a class="code" href="calibrate__bundle_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>).^2)));</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a02eacfd40be9042ceb0f07547365203d">  179</a></span>&#160;<a class="code" href="calibrate__bundle_8m.html#a02eacfd40be9042ceb0f07547365203d">options</a> = optimset(<span class="stringliteral">&#39;MaxIter&#39;</span>,1000,<span class="stringliteral">&#39;MaxFunEvals&#39;</span>,1000, ...</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                   <span class="stringliteral">&#39;Algorithm&#39;</span>,<span class="stringliteral">&#39;interior-point&#39;</span>, ...</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                   <span class="stringliteral">&#39;TolFun&#39;</span>, 1e-6, <span class="stringliteral">&#39;TolX&#39;</span>, 1e-6);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#aad05f78187c942f9dd521605fa81f1ba">  183</a></span>&#160;<a class="code" href="calibrate__bundle_8m.html#aad05f78187c942f9dd521605fa81f1ba">M</a> = <a class="code" href="calibrate__bundle_8m.html#a9efe1b79a6084bcab84c3832eaa5d305">numel</a>(<a class="code" href="calibrate__bundle_8m.html#ae3cc00512149507cae89440057d9f826">rel_p</a>);</div><div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#ab5e26523bbb8d11325537465d80b4ad5">  184</a></span>&#160;<a class="code" href="calibrate__bundle_8m.html#ab5e26523bbb8d11325537465d80b4ad5">rel_p_median</a> = nan(3, <a class="code" href="calibrate__bundle_8m.html#a9efe1b79a6084bcab84c3832eaa5d305">numel</a>(<a class="code" href="calibrate__bundle_8m.html#ad535ca0e3610b60b02342f8e2e340ff6">other_ids</a>));</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keywordflow">for</span> <a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a> = 1:<a class="code" href="calibrate__bundle_8m.html#aad05f78187c942f9dd521605fa81f1ba">M</a></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    % <a class="code" href="calibrate__bundle_8m.html#ad32cd9bf571422a392db4b58204973f5">Compute</a> the mean position as the initial value <span class="keywordflow">for</span> the minimization</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    % problem</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    p_0 = mean(<a class="code" href="calibrate__bundle_8m.html#ae3cc00512149507cae89440057d9f826">rel_p</a>{<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>},2);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    </div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    % <a class="code" href="calibrate__bundle_8m.html#ad32cd9bf571422a392db4b58204973f5">Compute</a> the geometric <a class="code" href="calibrate__bundle_8m.html#ae639a88582eea86bcb25fb056e42cf8f">median</a></div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#ae639a88582eea86bcb25fb056e42cf8f">  191</a></span>&#160;    [rel_p_median(:,i),~,exitflag] = ...</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                fminsearch(@(<a class="code" href="calibrate__bundle_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>) geometricMedianCost(<a class="code" href="calibrate__bundle_8m.html#ae3cc00512149507cae89440057d9f826">rel_p</a>{<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>}, <a class="code" href="calibrate__bundle_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>), p_0, <a class="code" href="calibrate__bundle_8m.html#a02eacfd40be9042ceb0f07547365203d">options</a>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="calibrate__bundle_8m.html#a8952d55956d33eb0cbb8d7fc82c40039">assert</a>(exitflag == 1, ...</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;           sprintf([<span class="stringliteral">&#39;Geometric median minimization did &#39;</span> ...</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                    <span class="stringliteral">&#39;not converge (exitflag %d)&#39;</span>], exitflag));</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;end</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;%% <a class="code" href="calibrate__bundle_8m.html#ad32cd9bf571422a392db4b58204973f5">Compute</a> the average orientation of each tag with respect to the master tag</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#ad3d8364041c3e32b7877d2f7e5c43e9d">  200</a></span>&#160;<a class="code" href="calibrate__bundle_8m.html#ad3d8364041c3e32b7877d2f7e5c43e9d">rel_q_mean</a> = nan(4, <a class="code" href="calibrate__bundle_8m.html#a9efe1b79a6084bcab84c3832eaa5d305">numel</a>(<a class="code" href="calibrate__bundle_8m.html#ad535ca0e3610b60b02342f8e2e340ff6">other_ids</a>));</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keywordflow">for</span> <a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a> = 1:<a class="code" href="calibrate__bundle_8m.html#aad05f78187c942f9dd521605fa81f1ba">M</a></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    % Use the method in Landis et al. <span class="stringliteral">&quot;Averaging Quaternions&quot;</span>, JGCD 2007</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    </div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    % Check the sufficient uniqueness condition</div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a9bd68a23b646d409b8e680f2c7df78b7">  205</a></span>&#160;    % TODO <span class="keyword">this</span> is <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a> computational bottleness - without this check, script</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    % returns much faster. Any way to speed up this double-for-loop?</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="calibrate__bundle_8m.html#a1d860fdeb45e53872d16f13188080953">error_angle</a>{<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>} = [];</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">for</span> <a class="code" href="calibrate__bundle_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 1:size(<a class="code" href="calibrate__bundle_8m.html#a3d397ecd447996fc6a53b1425b07ab69">rel_q</a>{<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>},2)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        q_1 = <a class="code" href="calibrate__bundle_8m.html#a3d397ecd447996fc6a53b1425b07ab69">rel_q</a>{<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>}(:,<a class="code" href="calibrate__bundle_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">for</span> <a class="code" href="calibrate__bundle_8m.html#a1c73327b2882639bc9f5e416bb3cc7ac">k</a> = 1:size(<a class="code" href="calibrate__bundle_8m.html#a3d397ecd447996fc6a53b1425b07ab69">rel_q</a>{<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>},2)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="keywordflow">if</span> <a class="code" href="calibrate__bundle_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>==k</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            end</div><div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a5d59e7713af288b698cb530d9b7b1e77">  214</a></span>&#160;            <a class="code" href="calibrate__bundle_8m.html#a5d59e7713af288b698cb530d9b7b1e77">q_2</a> = <a class="code" href="calibrate__bundle_8m.html#a3d397ecd447996fc6a53b1425b07ab69">rel_q</a>{<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>}(:,<a class="code" href="calibrate__bundle_8m.html#a1c73327b2882639bc9f5e416bb3cc7ac">k</a>);</div><div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a925f511d042c9cde0fcf3f2f69caf4a9">  215</a></span>&#160;            <a class="code" href="calibrate__bundle_8m.html#a925f511d042c9cde0fcf3f2f69caf4a9">q_error</a> = quatmult(quatinv(q_1),<a class="code" href="calibrate__bundle_8m.html#a5d59e7713af288b698cb530d9b7b1e77">q_2</a>);</div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#abff91f364f3043130b792d198d91f425">  216</a></span>&#160;            % Saturate to <a class="code" href="zed__image__splitter_8cpp.html#a28e3c179a86f337095088b3ca02a2b2a">valid</a> <a class="code" href="calibrate__bundle_8m.html#a7a085bfd72f95351f74ccd319a4095ff">acos</a> <a class="code" href="calibrate__bundle_8m.html#abff91f364f3043130b792d198d91f425">range</a>, which prevents imaginary output</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            % from <a class="code" href="calibrate__bundle_8m.html#a7a085bfd72f95351f74ccd319a4095ff">acos</a> due to <a class="code" href="calibrate__bundle_8m.html#a008f601fa614ff27de6491533cc70e86">q_error_w</a> being <a class="code" href="calibrate__bundle_8m.html#a50fbd6ec39390affeaebd88aa14d6ad6">infinitesimaly</a> (to numerical</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            % precision) outside of <a class="code" href="zed__image__splitter_8cpp.html#a28e3c179a86f337095088b3ca02a2b2a">valid</a> [-1,1] range</div><div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a008f601fa614ff27de6491533cc70e86">  219</a></span>&#160;            <a class="code" href="calibrate__bundle_8m.html#a008f601fa614ff27de6491533cc70e86">q_error_w</a> = min(1,max(<a class="code" href="calibrate__bundle_8m.html#a925f511d042c9cde0fcf3f2f69caf4a9">q_error</a>(1),-1));</div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a1d860fdeb45e53872d16f13188080953">  220</a></span>&#160;            <a class="code" href="calibrate__bundle_8m.html#a1d860fdeb45e53872d16f13188080953">error_angle</a>{<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>}(end+1) = 2*<a class="code" href="calibrate__bundle_8m.html#a7a085bfd72f95351f74ccd319a4095ff">acos</a>(<a class="code" href="calibrate__bundle_8m.html#a008f601fa614ff27de6491533cc70e86">q_error_w</a>);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">if</span> 2*<a class="code" href="calibrate__bundle_8m.html#a7a085bfd72f95351f74ccd319a4095ff">acos</a>(<a class="code" href="calibrate__bundle_8m.html#a008f601fa614ff27de6491533cc70e86">q_error_w</a>) &gt;= pi/2</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <a class="code" href="calibrate__bundle_8m.html#a9a14acbfbd4dcb52d913b15fa2595bd8">warning</a>([<span class="stringliteral">&#39;Quaternion pair q_%u and q_%u for tag ID %u &#39;</span> ...</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                         <span class="stringliteral">&#39;are more than 90 degrees apart!&#39;</span>], ...</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                        <a class="code" href="calibrate__bundle_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>,k,<a class="code" href="calibrate__bundle_8m.html#ad535ca0e3610b60b02342f8e2e340ff6">other_ids</a>(<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>));</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            end</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        end</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    end</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    </div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    % Average quaternion method</div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#add818468e1d5b00894d4e90f6b8b7206">  230</a></span>&#160;    <a class="code" href="calibrate__bundle_8m.html#add818468e1d5b00894d4e90f6b8b7206">Q</a> = <a class="code" href="calibrate__bundle_8m.html#a3d397ecd447996fc6a53b1425b07ab69">rel_q</a>{<a class="code" href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a>};</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    [V, D] = eig(<a class="code" href="calibrate__bundle_8m.html#add818468e1d5b00894d4e90f6b8b7206">Q</a>*<a class="code" href="calibrate__bundle_8m.html#add818468e1d5b00894d4e90f6b8b7206">Q</a>.<span class="stringliteral">&#39;);</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="stringliteral">    [~,imax] = max(diag(D)); % Get the largest eigenvalue</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="stringliteral">    rel_q_mean(:,i) = V(:,imax); % Corresponding eigenvector</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="stringliteral">    if rel_q_mean(1,i) &lt; 0</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="stringliteral">        rel_q_mean(:,i) = -rel_q_mean(:,i); % Ensure w positive</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="stringliteral">    end</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="stringliteral">end</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="stringliteral">%% Print output to paste in tags.yaml</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="stringliteral">% Head + master tag</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="stringliteral">fprintf([ ...</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="stringliteral">&#39;</span>tag_bundles:\n<span class="stringliteral">&#39; ...</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="stringliteral">&#39;</span>  [\n<span class="stringliteral">&#39; ...</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="stringliteral">&#39;</span>    {\n<span class="stringliteral">&#39; ...</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="stringliteral">&#39;</span>      name: <span class="stringliteral">&#39;&#39;</span>%s<span class="stringliteral">&#39;&#39;</span>,\n<span class="stringliteral">&#39; ...</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="stringliteral">&#39;</span>      layout:\n<span class="stringliteral">&#39; ...</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="stringliteral">&#39;</span>        [\n<span class="stringliteral">&#39;], bundle_name);</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="stringliteral">% All other tags detected at least once together with master tag</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="stringliteral">for i = 0:numel(other_ids)</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="stringliteral">    newline = &#39;</span>,<span class="stringliteral">&#39;;</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="stringliteral">    if i == numel(other_ids)</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="stringliteral">        newline = &#39;</span><span class="stringliteral">&#39;;</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="stringliteral">    end</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="stringliteral">    if i == 0</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="stringliteral">        fprintf(&#39;</span>          {id: %d, size: %.2f, x: %.4f, y: %.4f, z: %.4f, qw: %.4f, qx: %.4f, qy: %.4f, qz: %.4f}%s\n<span class="stringliteral">&#39;, ...</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="stringliteral">                master_id, master_size, 0, 0, 0, 1, 0, 0, 0, newline);</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="stringliteral">    else</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="stringliteral">        fprintf(&#39;</span>          {id: %d, size: %.2f, x: %.4f, y: %.4f, z: %.4f, qw: %.4f, qx: %.4f, qy: %.4f, qz: %.4f}%s\n<span class="stringliteral">&#39;, ...</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="stringliteral">                other_ids(i), other_sizes(i), rel_p_median(1,i), ...</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="stringliteral">                rel_p_median(2,i), rel_p_median(3,i), rel_q_mean(1,i), ...</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="stringliteral">                rel_q_mean(2,i), rel_q_mean(3,i), rel_q_mean(4,i), newline);</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="stringliteral">    end</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="stringliteral">end</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="stringliteral">% Tail</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="stringliteral">fprintf([ ...</span></div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#ae47557413b2f57612b37bfeaefb89b94">  269</a></span>&#160;<span class="stringliteral">&#39;</span>        ]\n<span class="stringliteral">&#39;...</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="stringliteral">&#39;</span>    }\n<span class="stringliteral">&#39;...</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="stringliteral">&#39;</span>  ]\n<span class="stringliteral">&#39;]);</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="stringliteral">%% Local functions</span></div><div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#acb95449a94688af33f6e9bb090cf2936">  274</a></span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="stringliteral">function t = getBagTime(bagfile)</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="stringliteral">    t = double(bagfile.header.stamp.sec)+ ...</span></div><div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">  277</a></span>&#160;<span class="stringliteral">        double(bagfile.header.stamp.nsec)/1e9;</span></div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">  278</a></span>&#160;<span class="stringliteral">end</span></div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a25ed1bcb423b0b7200f485fc5ff71c8e">  279</a></span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="stringliteral">function R = quat2rotmat(q)</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="stringliteral">    % Creates an ACTIVE rotation matrix from a quaternion</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="stringliteral">    w = q(1);</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="stringliteral">    x = q(2);</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="stringliteral">    y = q(3);</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="stringliteral">    z = q(4);</span></div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#abe85f2574c2d47a497bf41030ac456a0">  286</a></span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="stringliteral">    R = [1-2*(y^2+z^2)  2*(x*y-w*z)    2*(x*z+w*y)</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="stringliteral">         2*(x*y+w*z)    1-2*(x^2+z^2)  2*(y*z-w*x)</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="stringliteral">         2*(x*z-w*y)    2*(y*z+w*x)    1-2*(x^2+y^2)];</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="stringliteral">end</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a25eba7269701001993de85f2fa5df598">  292</a></span>&#160;<span class="stringliteral">function q = rotmat2quat(R)</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="stringliteral">    % Adapted for MATLAB from</span></div><div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#aa71e92c5bc82e6f66cf662f14f2cee7f">  294</a></span>&#160;<span class="stringliteral">    % http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/</span></div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a11c605501e726325aa170897acebe463">  295</a></span>&#160;<span class="stringliteral">    tr = R(1,1) + R(2,2) + R(3,3);</span></div><div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#adad6819d090d40b1ede7988231b6eb72">  296</a></span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="stringliteral">    if tr &gt; 0</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="stringliteral">      S = sqrt(tr+1.0) * 2; % S=4*qw </span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="stringliteral">      qw = 0.25 * S;</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="stringliteral">      qx = (R(3,2) - R(2,3)) / S;</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="stringliteral">      qy = (R(1,3) - R(3,1)) / S; </span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="stringliteral">      qz = (R(2,1) - R(1,2)) / S; </span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="stringliteral">    elseif (R(1,1) &gt; R(2,2)) &amp;&amp; (R(1,1) &gt; R(3,3)) </span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="stringliteral">      S = sqrt(1.0 + R(1,1) - R(2,2) - R(3,3)) * 2; % S=4*qx </span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="stringliteral">      qw = (R(3,2) - R(2,3)) / S;</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="stringliteral">      qx = 0.25 * S;</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="stringliteral">      qy = (R(1,2) + R(2,1)) / S; </span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="stringliteral">      qz = (R(1,3) + R(3,1)) / S; </span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="stringliteral">    elseif (R(2,2) &gt; R(3,3))</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="stringliteral">      S = sqrt(1.0 + R(2,2) - R(1,1) - R(3,3)) * 2; % S=4*qy</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="stringliteral">      qw = (R(1,3) - R(3,1)) / S;</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="stringliteral">      qx = (R(1,2) + R(2,1)) / S; </span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="stringliteral">      qy = 0.25 * S;</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="stringliteral">      qz = (R(2,3) + R(3,2)) / S; </span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="stringliteral">    else</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="stringliteral">      S = sqrt(1.0 + R(3,3) - R(1,1) - R(2,2)) * 2; % S=4*qz</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="stringliteral">      qw = (R(2,1) - R(1,2)) / S;</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="stringliteral">      qx = (R(1,3) + R(3,1)) / S;</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="stringliteral">      qy = (R(2,3) + R(3,2)) / S;</span></div><div class="line"><a name="l00320"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#ae0323a9039add2978bf5b49550572c7c">  320</a></span>&#160;<span class="stringliteral">      qz = 0.25 * S;</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="stringliteral">    end</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="stringliteral">    q = [qw qx qy qz]&#39;</span>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;end</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#afc1571a6060e2ba212ba42f8f2f95d7d">  326</a></span>&#160;<span class="keyword">function</span> <a class="code" href="calibrate__bundle_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a> = quatmult(<a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>,b)</div><div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a17470ea760362d5b99891312e8791bc9">  327</a></span>&#160;    % More humanly understandable <a class="code" href="calibrate__bundle_8m.html#afc1571a6060e2ba212ba42f8f2f95d7d">version</a>:</div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a962d025eba92640823afd80489b1759d">  328</a></span>&#160;    % Omegaa = [a((1)) -a((2):(4)).&#39;</div><div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#a4527245ee51fe5174f7e51fe42cc0364">  329</a></span>&#160;    %           a((2):(4)) a((1))*eye((3))-[0 -a((4)) a((3)); a((4)) 0 -a((2));-a((3)) a((2)) 0]];</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    % <a class="code" href="calibrate__bundle_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a> = Omegaa*b;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    % More optimized <a class="code" href="calibrate__bundle_8m.html#afc1571a6060e2ba212ba42f8f2f95d7d">version</a>:</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    c_w = <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(1)*b(1) - <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(2)*b(2) - <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(3)*b(3) - <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(4)*b(4);</div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="calibrate__bundle_8m.html#ad3c8a7fbffc471336e3a84a1c4b18cb1">  333</a></span>&#160;    <a class="code" href="calibrate__bundle_8m.html#a17470ea760362d5b99891312e8791bc9">c_x</a> = <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(1)*b(2) + <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(2)*b(1) - <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(3)*b(4) + <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(4)*b(3);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="calibrate__bundle_8m.html#a962d025eba92640823afd80489b1759d">c_y</a> = <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(1)*b(3) + <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(3)*b(1) + <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(2)*b(4) - <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(4)*b(2);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="calibrate__bundle_8m.html#a4527245ee51fe5174f7e51fe42cc0364">c_z</a> = <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(1)*b(4) - <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(2)*b(3) + <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(3)*b(2) + <a class="code" href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a>(4)*b(1);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="calibrate__bundle_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a> = [c_w; c_x; c_y; c_z];</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;end</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keyword">function</span> <a class="code" href="calibrate__bundle_8m.html#ad3c8a7fbffc471336e3a84a1c4b18cb1">qinv</a> = quatinv(<a class="code" href="calibrate__bundle_8m.html#abe85f2574c2d47a497bf41030ac456a0">q</a>)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    qinv = [q(1); -q(2:4)];</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;end</div><div class="ttc" id="calibrate__bundle_8m_html_a987ae9273855c828e2e611d2935a96b2"><div class="ttname"><a href="calibrate__bundle_8m.html#a987ae9273855c828e2e611d2935a96b2">SPECIAL</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY SPECIAL</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00004">calibrate_bundle.m:4</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_af8252c84f38d7f022417a5ce3465e3c9"><div class="ttname"><a href="calibrate__bundle_8m.html#af8252c84f38d7f022417a5ce3465e3c9">TORT</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY OR CONSEQUENTIAL WHETHER IN STRICT OR TORT(INCLUDING NEGLIGENCE OR OTHERWISE) % ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ad7e72802b40389f0ea2ed801de3897c5"><div class="ttname"><a href="calibrate__bundle_8m.html#ad7e72802b40389f0ea2ed801de3897c5">INDIRECT</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY INDIRECT</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00004">calibrate_bundle.m:4</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a8cc2e7240164328fdc3f0e5e21032c56"><div class="ttname"><a href="calibrate__bundle_8m.html#a8cc2e7240164328fdc3f0e5e21032c56">N</a></div><div class="ttdeci">N</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00076">calibrate_bundle.m:76</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a5d59e7713af288b698cb530d9b7b1e77"><div class="ttname"><a href="calibrate__bundle_8m.html#a5d59e7713af288b698cb530d9b7b1e77">q_2</a></div><div class="ttdeci">end q_2</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00214">calibrate_bundle.m:214</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a1c73327b2882639bc9f5e416bb3cc7ac"><div class="ttname"><a href="calibrate__bundle_8m.html#a1c73327b2882639bc9f5e416bb3cc7ac">k</a></div><div class="ttdeci">for k</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00088">calibrate_bundle.m:88</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a50fbd6ec39390affeaebd88aa14d6ad6"><div class="ttname"><a href="calibrate__bundle_8m.html#a50fbd6ec39390affeaebd88aa14d6ad6">infinitesimaly</a></div><div class="ttdeci">Saturate to valid acos which prevents imaginary output from acos due to q_error_w being infinitesimaly(to numerical % precision) outside of valid [-1</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ae0323a9039add2978bf5b49550572c7c"><div class="ttname"><a href="calibrate__bundle_8m.html#ae0323a9039add2978bf5b49550572c7c">c</a></div><div class="ttdeci">end function c</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00320">calibrate_bundle.m:320</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_acd396a48b4db0c132830da5344b80f52"><div class="ttname"><a href="calibrate__bundle_8m.html#acd396a48b4db0c132830da5344b80f52">Copyright</a></div><div class="ttdeci">Copyright(c) 2017</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ad3ac51e0375854d7a661b4f908f683af"><div class="ttname"><a href="calibrate__bundle_8m.html#ad3ac51e0375854d7a661b4f908f683af">T_mj</a></div><div class="ttdeci">Deduce this tag s rigid body transform to the master tag s frame T_mj</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00163">calibrate_bundle.m:163</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a4527245ee51fe5174f7e51fe42cc0364"><div class="ttname"><a href="calibrate__bundle_8m.html#a4527245ee51fe5174f7e51fe42cc0364">c_z</a></div><div class="ttdeci">c_z</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00329">calibrate_bundle.m:329</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ad3d8364041c3e32b7877d2f7e5c43e9d"><div class="ttname"><a href="calibrate__bundle_8m.html#ad3d8364041c3e32b7877d2f7e5c43e9d">rel_q_mean</a></div><div class="ttdeci">end Compute the average orientation of each tag with respect to the master tag rel_q_mean</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00200">calibrate_bundle.m:200</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a7d76769c15bfc45fe75d2ed2a9fe5cdd"><div class="ttname"><a href="calibrate__bundle_8m.html#a7d76769c15bfc45fe75d2ed2a9fe5cdd">modification</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without modification</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00004">calibrate_bundle.m:4</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a9dddf8cd86c71d19636e1fe429f3a434"><div class="ttname"><a href="calibrate__bundle_8m.html#a9dddf8cd86c71d19636e1fe429f3a434">INCIDENTAL</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY INCIDENTAL</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00004">calibrate_bundle.m:4</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a6c9a6acbd4cc26c581472fecdbf0fad6"><div class="ttname"><a href="calibrate__bundle_8m.html#a6c9a6acbd4cc26c581472fecdbf0fad6">detection</a></div><div class="ttdeci">end tag_data detection(i).id(j)</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a17470ea760362d5b99891312e8791bc9"><div class="ttname"><a href="calibrate__bundle_8m.html#a17470ea760362d5b99891312e8791bc9">c_x</a></div><div class="ttdeci">c_x</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00327">calibrate_bundle.m:327</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ae3cc00512149507cae89440057d9f826"><div class="ttname"><a href="calibrate__bundle_8m.html#ae3cc00512149507cae89440057d9f826">rel_p</a></div><div class="ttdeci">rel_p</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00113">calibrate_bundle.m:113</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a6d62b956953d9abe2c0942f1ebc5ad64"><div class="ttname"><a href="calibrate__bundle_8m.html#a6d62b956953d9abe2c0942f1ebc5ad64">Instructions</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY OR CONSEQUENTIAL WHETHER IN STRICT OR EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE The views and conclusions contained in the software and documentation are those of the authors and should not be interpreted as representing official either expressed or of the California Institute of Technology calibrate_bundle m Script to determine AprilTag bundle relative poses to a master tag Instructions</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00027">calibrate_bundle.m:27</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ad336ad6e7893fa37df25bdeb0559b982"><div class="ttname"><a href="calibrate__bundle_8m.html#ad336ad6e7893fa37df25bdeb0559b982">implied</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY OR CONSEQUENTIAL WHETHER IN STRICT OR EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE The views and conclusions contained in the software and documentation are those of the authors and should not be interpreted as representing official either expressed or implied</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00027">calibrate_bundle.m:27</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a9336ebf25087d91c818ee6e9ec29f8c1"><div class="ttname"><a href="calibrate__bundle_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a></div><div class="ttdeci">x</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00277">calibrate_bundle.m:277</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ad594c392dd903bd23c1855725b0dc8ed"><div class="ttname"><a href="calibrate__bundle_8m.html#ad594c392dd903bd23c1855725b0dc8ed">frame</a></div><div class="ttdeci">end We already have the rigid body transform from the master tag to the camera frame(T_cm) if j</div></div>
<div class="ttc" id="zed__image__splitter_8cpp_html_a28e3c179a86f337095088b3ca02a2b2a"><div class="ttname"><a href="zed__image__splitter_8cpp.html#a28e3c179a86f337095088b3ca02a2b2a">valid</a></div><div class="ttdeci">bool valid</div><div class="ttdef"><b>Definition:</b> <a href="zed__image__splitter_8cpp_source.html#l00049">zed_image_splitter.cpp:49</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ab5e26523bbb8d11325537465d80b4ad5"><div class="ttname"><a href="calibrate__bundle_8m.html#ab5e26523bbb8d11325537465d80b4ad5">rel_p_median</a></div><div class="ttdeci">rel_p_median</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00184">calibrate_bundle.m:184</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ad535ca0e3610b60b02342f8e2e340ff6"><div class="ttname"><a href="calibrate__bundle_8m.html#ad535ca0e3610b60b02342f8e2e340ff6">other_ids</a></div><div class="ttdeci">Size of the master tag relative positions and orientations of detected tags other than master other_ids</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00111">calibrate_bundle.m:111</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a2fb1c5cf58867b5bbc9a1b145a86f3a0"><div class="ttname"><a href="calibrate__bundle_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a></div><div class="ttdeci">y</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00278">calibrate_bundle.m:278</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_afc1571a6060e2ba212ba42f8f2f95d7d"><div class="ttname"><a href="calibrate__bundle_8m.html#afc1571a6060e2ba212ba42f8f2f95d7d">version</a></div><div class="ttdeci">More optimized version</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00326">calibrate_bundle.m:326</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a3d397ecd447996fc6a53b1425b07ab69"><div class="ttname"><a href="calibrate__bundle_8m.html#a3d397ecd447996fc6a53b1425b07ab69">rel_q</a></div><div class="ttdeci">rel_q</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00114">calibrate_bundle.m:114</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a705cd5bdd35b459ea24d381571333acc"><div class="ttname"><a href="calibrate__bundle_8m.html#a705cd5bdd35b459ea24d381571333acc">forms</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary forms</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00004">calibrate_bundle.m:4</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="calibrate__bundle_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00080">calibrate_bundle.m:80</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a9a14acbfbd4dcb52d913b15fa2595bd8"><div class="ttname"><a href="calibrate__bundle_8m.html#a9a14acbfbd4dcb52d913b15fa2595bd8">warning</a></div><div class="ttdeci">end warning(warning_str)</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ae067d3d934beb2040430002191957cde"><div class="ttname"><a href="calibrate__bundle_8m.html#ae067d3d934beb2040430002191957cde">a</a></div><div class="ttdeci">a((4)) 0 -a((2))</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a7a085bfd72f95351f74ccd319a4095ff"><div class="ttname"><a href="calibrate__bundle_8m.html#a7a085bfd72f95351f74ccd319a4095ff">acos</a></div><div class="ttdeci">if * acos(q_error_w) &gt;</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a1e5f3898fffb0324d578e7d90b643abf"><div class="ttname"><a href="calibrate__bundle_8m.html#a1e5f3898fffb0324d578e7d90b643abf">addpath</a></div><div class="ttdeci">delete matlab_rosbag zip end addpath('matlab_rosbag-0.5.0-linux64')</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ae639a88582eea86bcb25fb056e42cf8f"><div class="ttname"><a href="calibrate__bundle_8m.html#ae639a88582eea86bcb25fb056e42cf8f">median</a></div><div class="ttdeci">Compute the geometric median[rel_p_median(:, i),~, exitflag]</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00191">calibrate_bundle.m:191</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ab550ba73e6c3fabd2e54f115310b27de"><div class="ttname"><a href="calibrate__bundle_8m.html#ab550ba73e6c3fabd2e54f115310b27de">~exist</a></div><div class="ttdeci">Make sure matlab_rosbag is installed if ~exist('matlab_rosbag-0.5.0-linux64', 'file') websave('matlab_rosbag'</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_acc4d6b48da0d384bf76fb5a2b91b7ce7"><div class="ttname"><a href="calibrate__bundle_8m.html#acc4d6b48da0d384bf76fb5a2b91b7ce7">bag</a></div><div class="ttdeci">Load the tag detections bagfile bag</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00072">calibrate_bundle.m:72</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a2742dea88630f6cbb9f2eeb9934c042b"><div class="ttname"><a href="calibrate__bundle_8m.html#a2742dea88630f6cbb9f2eeb9934c042b">IDs</a></div><div class="ttdeci">Size of the master tag IDs</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00109">calibrate_bundle.m:109</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a173622265492b0e123fcbfeb0ff5b9da"><div class="ttname"><a href="calibrate__bundle_8m.html#a173622265492b0e123fcbfeb0ff5b9da">T_cm</a></div><div class="ttdeci">end Get the master tag s rigid body transform to the camera frame T_cm</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00131">calibrate_bundle.m:131</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_afd3552fc9c021802bcca141906b113e2"><div class="ttname"><a href="calibrate__bundle_8m.html#afd3552fc9c021802bcca141906b113e2">met</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are met</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00004">calibrate_bundle.m:4</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_adf5d401532f8842c951b3e0bfd4cef1d"><div class="ttname"><a href="calibrate__bundle_8m.html#adf5d401532f8842c951b3e0bfd4cef1d">notice</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright notice</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00004">calibrate_bundle.m:4</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a8952d55956d33eb0cbb8d7fc82c40039"><div class="ttname"><a href="calibrate__bundle_8m.html#a8952d55956d33eb0cbb8d7fc82c40039">assert</a></div><div class="ttdeci">assert(numel(k)==1,... 'Tag ID must appear exactly once in the other_ids array')</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_abff91f364f3043130b792d198d91f425"><div class="ttname"><a href="calibrate__bundle_8m.html#abff91f364f3043130b792d198d91f425">range</a></div><div class="ttdeci">Saturate to valid acos range</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00216">calibrate_bundle.m:216</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a925f511d042c9cde0fcf3f2f69caf4a9"><div class="ttname"><a href="calibrate__bundle_8m.html#a925f511d042c9cde0fcf3f2f69caf4a9">q_error</a></div><div class="ttdeci">q_error</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00215">calibrate_bundle.m:215</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a295bfcf5774bc997b97e15adc0b1d905"><div class="ttname"><a href="calibrate__bundle_8m.html#a295bfcf5774bc997b97e15adc0b1d905">zeros</a></div><div class="ttdeci">zeros(1, 3) 1]</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a07825e8664427efae7ef6508fd93e9bf"><div class="ttname"><a href="calibrate__bundle_8m.html#a07825e8664427efae7ef6508fd93e9bf">LIABILITY</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY OR CONSEQUENTIAL WHETHER IN STRICT LIABILITY</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00021">calibrate_bundle.m:21</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a962d025eba92640823afd80489b1759d"><div class="ttname"><a href="calibrate__bundle_8m.html#a962d025eba92640823afd80489b1759d">c_y</a></div><div class="ttdeci">c_y</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00328">calibrate_bundle.m:328</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a6496c0951c659439045852eec09db971"><div class="ttname"><a href="calibrate__bundle_8m.html#a6496c0951c659439045852eec09db971">createT</a></div><div class="ttdeci">createT</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00116">calibrate_bundle.m:116</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ad3c8a7fbffc471336e3a84a1c4b18cb1"><div class="ttname"><a href="calibrate__bundle_8m.html#ad3c8a7fbffc471336e3a84a1c4b18cb1">qinv</a></div><div class="ttdeci">end function qinv</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00333">calibrate_bundle.m:333</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_abf673a30af09f0a420ff36f296c5f3ed"><div class="ttname"><a href="calibrate__bundle_8m.html#abf673a30af09f0a420ff36f296c5f3ed">tag_data</a></div><div class="ttdeci">clear tag_data</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00075">calibrate_bundle.m:75</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_abe85f2574c2d47a497bf41030ac456a0"><div class="ttname"><a href="calibrate__bundle_8m.html#abe85f2574c2d47a497bf41030ac456a0">q</a></div><div class="ttdeci">end function q</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00286">calibrate_bundle.m:286</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a64552557b4a532bc6a3a149262e9483e"><div class="ttname"><a href="calibrate__bundle_8m.html#a64552557b4a532bc6a3a149262e9483e">tag_msg</a></div><div class="ttdeci">tag_msg</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00073">calibrate_bundle.m:73</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_af48e1c93b0b5f3b48c95a67a0a78dfe1"><div class="ttname"><a href="calibrate__bundle_8m.html#af48e1c93b0b5f3b48c95a67a0a78dfe1">isempty</a></div><div class="ttdeci">if isempty(mi) % Master not detected in this detection</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a6c72f7107f7d766b1ff415f5c41c9b43"><div class="ttname"><a href="calibrate__bundle_8m.html#a6c72f7107f7d766b1ff415f5c41c9b43">EXEMPLARY</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY EXEMPLARY</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00004">calibrate_bundle.m:4</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ac87c5584234ed7130333c1b339ec7790"><div class="ttname"><a href="calibrate__bundle_8m.html#ac87c5584234ed7130333c1b339ec7790">WARRANTIES</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00004">calibrate_bundle.m:4</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a5fbc147f8af94915044776869de6f5d7"><div class="ttname"><a href="calibrate__bundle_8m.html#a5fbc147f8af94915044776869de6f5d7">CONTRACT</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY OR CONSEQUENTIAL WHETHER IN CONTRACT</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00021">calibrate_bundle.m:21</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_adde6ecd6406700aa000b213c843a3091"><div class="ttname"><a href="calibrate__bundle_8m.html#adde6ecd6406700aa000b213c843a3091">mi</a></div><div class="ttdeci">mi</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00123">calibrate_bundle.m:123</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a02eacfd40be9042ceb0f07547365203d"><div class="ttname"><a href="calibrate__bundle_8m.html#a02eacfd40be9042ceb0f07547365203d">options</a></div><div class="ttdeci">options</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00179">calibrate_bundle.m:179</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a34ee4b63acffbc412a5497f55f2881f7"><div class="ttname"><a href="calibrate__bundle_8m.html#a34ee4b63acffbc412a5497f55f2881f7">policies</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY OR CONSEQUENTIAL WHETHER IN STRICT OR EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE The views and conclusions contained in the software and documentation are those of the authors and should not be interpreted as representing official policies</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00027">calibrate_bundle.m:27</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a4eecb21645a8350cd54362b2c4a9fbb4"><div class="ttname"><a href="calibrate__bundle_8m.html#a4eecb21645a8350cd54362b2c4a9fbb4">calibration_file</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY OR CONSEQUENTIAL WHETHER IN STRICT OR EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE The views and conclusions contained in the software and documentation are those of the authors and should not be interpreted as representing official either expressed or of the California Institute of Technology calibrate_bundle m Script to determine AprilTag bundle relative poses to a master tag then copy the printed output into the tag yaml configuration file of apriltag_ros JPL User inputs Relative directory of calibration bagfile calibration_file</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00051">calibrate_bundle.m:51</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ab74631634c9cb3e501fc8704d1b0b555"><div class="ttname"><a href="calibrate__bundle_8m.html#ab74631634c9cb3e501fc8704d1b0b555">unzip</a></div><div class="ttdeci">Make sure matlab_rosbag is installed if unzip('matlab_rosbag')</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a008f601fa614ff27de6491533cc70e86"><div class="ttname"><a href="calibrate__bundle_8m.html#a008f601fa614ff27de6491533cc70e86">q_error_w</a></div><div class="ttdeci">Saturate to valid acos which prevents imaginary output from acos due to q_error_w being range q_error_w</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00219">calibrate_bundle.m:219</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ad32cd9bf571422a392db4b58204973f5"><div class="ttname"><a href="calibrate__bundle_8m.html#ad32cd9bf571422a392db4b58204973f5">Compute</a></div><div class="ttdeci">Compute(geometric) median position of each tag in master tag frame geometricMedianCost</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_aaa34ec533f1bca1d5d9bd87f9ed0b2a3"><div class="ttname"><a href="calibrate__bundle_8m.html#aaa34ec533f1bca1d5d9bd87f9ed0b2a3">T_cj</a></div><div class="ttdeci">Get this tag s rigid body transform to the camera frame T_cj</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00160">calibrate_bundle.m:160</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a9efe1b79a6084bcab84c3832eaa5d305"><div class="ttname"><a href="calibrate__bundle_8m.html#a9efe1b79a6084bcab84c3832eaa5d305">numel</a></div><div class="ttdeci">if numel(detection.id)&gt;1 % Can only use standalone tag detections for calibration! % The math allows for bundles too(e.g. bundle composed of % bundles) but the code does not</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_aee3a6a65859b34b5b3389bd171527e4a"><div class="ttname"><a href="calibrate__bundle_8m.html#aee3a6a65859b34b5b3389bd171527e4a">master_size</a></div><div class="ttdeci">Tag position with respect to camera frame tag_data detection(i).p(Tag orientation with respect to camera frame [w;x;y;z] format tag_data detection(i).q(end end Compute the measured poses of each tag relative to the master tag master_size</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00107">calibrate_bundle.m:107</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a61b080a1bddcca4885e3fbe16e656ea5"><div class="ttname"><a href="calibrate__bundle_8m.html#a61b080a1bddcca4885e3fbe16e656ea5">master_id</a></div><div class="ttdeci">Master tag s ID master_id</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00057">calibrate_bundle.m:57</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a2e4ce9aeeb12bfcdb92dae2a4692c8fb"><div class="ttname"><a href="calibrate__bundle_8m.html#a2e4ce9aeeb12bfcdb92dae2a4692c8fb">i</a></div><div class="ttdeci">for i</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00078">calibrate_bundle.m:78</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ae25585d9cb61ac315912013f54e3e7e9"><div class="ttname"><a href="calibrate__bundle_8m.html#ae25585d9cb61ac315912013f54e3e7e9">INCLUDING</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED INCLUDING</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00004">calibrate_bundle.m:4</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_aad05f78187c942f9dd521605fa81f1ba"><div class="ttname"><a href="calibrate__bundle_8m.html#aad05f78187c942f9dd521605fa81f1ba">M</a></div><div class="ttdeci">M</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00183">calibrate_bundle.m:183</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_aae64ddb735f96eb492f3a5bda673ad56"><div class="ttname"><a href="calibrate__bundle_8m.html#aae64ddb735f96eb492f3a5bda673ad56">invertT</a></div><div class="ttdeci">invertT</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00117">calibrate_bundle.m:117</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_abdb5a42ffee3ca622484b53a322f1004"><div class="ttname"><a href="calibrate__bundle_8m.html#abdb5a42ffee3ca622484b53a322f1004">t0</a></div><div class="ttdeci">t0</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00077">calibrate_bundle.m:77</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a7e04a887670387095ed2e645891ccda9"><div class="ttname"><a href="calibrate__bundle_8m.html#a7e04a887670387095ed2e645891ccda9">DAMAGES</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY OR CONSEQUENTIAL DAMAGES(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF % SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA, OR PROFITS;OR BUSINESS % INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY</div></div>
<div class="ttc" id="calibrate__bundle_8m_html_a1d860fdeb45e53872d16f13188080953"><div class="ttname"><a href="calibrate__bundle_8m.html#a1d860fdeb45e53872d16f13188080953">error_angle</a></div><div class="ttdeci">error_angle</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00220">calibrate_bundle.m:220</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ae35f8f99966db88a3f9822dedd999151"><div class="ttname"><a href="calibrate__bundle_8m.html#ae35f8f99966db88a3f9822dedd999151">DIRECT</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00004">calibrate_bundle.m:4</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_ac28fe2735bf913b42e4f1d0baf96b0f8"><div class="ttname"><a href="calibrate__bundle_8m.html#ac28fe2735bf913b42e4f1d0baf96b0f8">TO</a></div><div class="ttdeci">California Institute of Technology All rights reserved Redistribution and use in source and binary with or without are permitted provided that the following conditions are this list of conditions and the following disclaimer Redistributions in binary form must reproduce the above copyright this list of conditions and the following disclaimer in the documentation and or other materials provided with the distribution THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED BUT NOT LIMITED TO</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00004">calibrate_bundle.m:4</a></div></div>
<div class="ttc" id="calibrate__bundle_8m_html_add818468e1d5b00894d4e90f6b8b7206"><div class="ttname"><a href="calibrate__bundle_8m.html#add818468e1d5b00894d4e90f6b8b7206">Q</a></div><div class="ttdeci">end end end Average quaternion method Q</div><div class="ttdef"><b>Definition:</b> <a href="calibrate__bundle_8m_source.html#l00230">calibrate_bundle.m:230</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
